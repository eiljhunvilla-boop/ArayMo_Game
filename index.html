<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Runner Game Deluxe</title>
<style>
body{
    margin:0;
    display:flex;
    justify-content:center;
    align-items:center;
    height:100vh;
    font-family:Arial, sans-serif;
    background:#020617;
    color:#fff;
}

#menu,#game{
    width:360px;
    height:520px;
    background:#020617;
    border-radius:16px;
    box-shadow:0 20px 40px rgba(0,0,0,.6);
    overflow:hidden;
    position:relative;
}

#menu{padding:16px; text-align:center;}

.characters{
    display:grid;
    grid-template-columns:repeat(3,1fr);
    gap:10px;
}

.char{
    border:2px solid #1e293b;
    border-radius:12px;
    padding:6px;
    cursor:pointer;
    transition:.2s;
}

.char:hover{ transform:scale(1.05); }

.char.selected{
    border-color:#22c55e;
    background:#052e16;
}

.char img{
    width:100%;
    height:70px;
    object-fit:contain;
}

button{
    margin-top:14px;
    width:100%;
    padding:10px;
    border:none;
    border-radius:10px;
    background:#22c55e;
    font-weight:bold;
    cursor:pointer;
}

#hud{
    position:absolute;
    top:10px;
    width:100%;
    display:flex;
    justify-content:space-between;
    padding:0 16px;
    font-weight:bold;
    z-index:10;
}

canvas{
    display:block;
    background:#000;
}
</style>
</head>
<body>

<!-- MENU -->
<div id="menu">
    <h2>Runner Game Deluxe</h2>
    <p>Select Character</p>
    <div class="characters">
        <div class="char" data-img="/krexia.jpg"><img src="/krexia.jpg"><small>KREXIA</small></div>
        <div class="char" data-img="/rhoda.jpg"><img src="/rhoda.jpg"><small>RHODA</small></div>
        <div class="char" data-img="/eiljhun.jpg"><img src="/eiljhun.jpg"><small>EILJHUN</small></div>
        <div class="char" data-img="/cariza.jpg"><img src="/cariza.jpg"><small>CARIZA</small></div>
        <div class="char" data-img="/aldrid.jpg"><img src="/aldrid.jpg"><small>ALDRID</small></div>
        <div class="char" data-img="/wilfred.jpg"><img src="/wilfred.jpg"><small>WILFRED</small></div>
        <div class="char" data-img="/jullen.jpg"><img src="/jullen.jpg"><small>JULLEN</small></div>
    </div>
    <button id="startBtn">START GAME</button>
</div>

<!-- GAME -->
<div id="game" style="display:none">
    <div id="hud">
        <div>Score: <span id="score">0</span></div>
        <div>Best: <span id="best">0</span></div>
    </div>
    <canvas id="canvas" width="360" height="520"></canvas>
</div>

<!-- AUDIO -->
<audio id="bgm" src="/bgm.mp3" loop></audio>
<audio id="jumpSound" src="/jump.mp3"></audio>
<audio id="hitSound" src="/hit.mp3"></audio>

<script>
const canvas = document.getElementById('canvas');
const ctx = canvas.getContext('2d');

const bgImg = new Image();
bgImg.src = "/bg.jpg";

const obstacleImg = new Image();
obstacleImg.src = "/obstacle.jpg";

let player, obstacles, score, best, gameOver, frame;
let selectedImg = null;

const groundY = 420;
const gravity = 0.6;
const jumpPower = -12;
const speed = 4;

const bgm = document.getElementById('bgm');
const jumpSound = document.getElementById('jumpSound');
const hitSound = document.getElementById('hitSound');

// CHARACTER SELECT
document.querySelectorAll('.char').forEach(c=>{
    c.onclick = () => {
        document.querySelectorAll('.char').forEach(x=>x.classList.remove('selected'));
        c.classList.add('selected');
        selectedImg = c.dataset.img;
    };
});

// BEST SCORE
best = localStorage.getItem('runnerBest') || 0;
document.getElementById('best').innerText = best;

// START GAME
document.getElementById('startBtn').onclick = ()=>{
    if(!selectedImg){
        alert("Select a character!");
        return;
    }
    document.getElementById('menu').style.display='none';
    document.getElementById('game').style.display='block';
    bgm.play();
    startGame();
};

// GAME START
function startGame(){
    player = { x:60, y:groundY-50, w:42, h:42, vy:0, onGround:true, img:new Image() };
    player.img.src = selectedImg;

    obstacles = [];
    score = 0;
    frame = 0;
    gameOver = false;

    loop();
}

// INPUT
function jump(){
    if(player.onGround && !gameOver){
        player.vy = jumpPower;
        player.onGround = false;
        jumpSound.currentTime = 0;
        jumpSound.play();
    }
}
canvas.onclick = jump;
document.onkeydown = e => { if(e.code==='Space') jump(); };

// GAME LOOP
function loop(){
    if(gameOver) return;
    frame++;

    ctx.clearRect(0,0,360,520);

    // Background
    ctx.drawImage(bgImg, 0, 0, canvas.width, canvas.height);

    // Ground
    ctx.fillStyle="rgba(30,41,59,0.6)";
    ctx.fillRect(0, groundY, 360, 100);

    // Player physics
    player.vy += gravity;
    player.y += player.vy;
    if(player.y + player.h >= groundY){
        player.y = groundY - player.h;
        player.vy = 0;
        player.onGround = true;
    }
    ctx.drawImage(player.img, player.x, player.y, player.w, player.h);

    // Obstacles
    if(frame % 90 === 0){
        obstacles.push({ x:360, w:36, h:48 });
    }
    obstacles.forEach(o=>{
        o.x -= speed;
        ctx.drawImage(obstacleImg, o.x, groundY - o.h, o.w, o.h);

        if(player.x < o.x + o.w && player.x + player.w > o.x && player.y + player.h > groundY - o.h){
            endGame();
        }
    });

    obstacles = obstacles.filter(o => o.x > -60);

    score++;
    document.getElementById('score').innerText = score;

    requestAnimationFrame(loop);
}

// GAME OVER
function endGame(){
    gameOver = true;
    bgm.pause();
    hitSound.currentTime = 0;
    hitSound.play();

    if(score > best){
        best = score;
        localStorage.setItem('runnerBest', best);
    }

    setTimeout(()=>{
        alert("Game Over!\nScore: "+score);
        location.reload();
    },200);
}
</script>
</body>
</html>
